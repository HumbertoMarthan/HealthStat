<ui:composition xmlns="http://www.w3.org/1999/xhtml"
	xmlns:h="http://java.sun.com/jsf/html"
	xmlns:f="http://java.sun.com/jsf/core"
	xmlns:util="http://java.sun.com/jsf/composite/componentes"
	xmlns:ui="http://java.sun.com/jsf/facelets"
	xmlns:p="http://primefaces.org/ui" template="/WEB-INF/template.xhtml">

	<ui:define name="title">Pagina Inicial</ui:define>

	<ui:define name="head">

		<style type="text/css">
.ui-g label {
	font-size: medium;
	color: black;
	font-weight: bold
}

.ui-selectoneradio label {
	cursor: pointer;
	display: inline-block;
	margin: 0 16px 0 8px;
	vertical-align: middle;
	/*color: #2e6e9e !important;*/
	font-size: medium;
}

.ui-state-default, .ui-widget-content .ui-state-default,
	.ui-widget-header .ui-state-default {
	border: 1px solid #c5dbec;
	font-weight: bold;
	color: black;
}

.ui-fluid .ui-inputmask {
	font-size: 20px;
	width: 100%;
	text-align: center;
	height: 35px;
	color: black;
}

.ui-fluid .ui-inputtext {
	width: 100%;
	height: 35px;
	font-size: large;
	text-align: center;
	color: black;
}

.ui-fluid .ui-inputtextarea {
	width: 100%;
	height: 35px !important;
	color: black;
}

.ui-fluid .ui-calendar, .ui-fluid .ui-calendar input {
	width: 100%;
	height: 35px;
	/*font-size: 20px !important;*/
	text-align: center;
	color: black;
}

.ui-selectonemenu label.ui-selectonemenu-label {
	cursor: pointer;
	height: 33px;
	font-size: 20px;
	text-align: center;
}

.ui-selectoneradio label {
	cursor: pointer;
	display: inline-block;
	margin: 0 16px 0 8px;
	vertical-align: middle;
	/*color: #2e6e9e !important;*/
	font-size: medium;
}

.ui-autocomplete-input.ui-autocomplete-dd-input {
	padding-right: 2.4em;
	height: 35px;
	text-align: center;
}

.consulta {
	background-color: red !important;
}

.retorno {
	background-color: green !important;
}

.confirmaConsulta {
	background-color: blue !important;
}

.value {
	font-weight: bold;
}

.ui-carousel {
	margin-bottom: 20px;
}

.tituloCard {
	background: none;
	padding: 0.5em 1em;
	background-color: #5c9ccc;
	color: white;
	text-align: center;
}

.subEspecialidade {
	background: none;
	padding: 0.5em 1em;
	color: white;
	text-align: left;
}

.valorConsulta {
	background: none;
	padding: 0.5em 1em;
	background-color: #5c9ccc;
	color: white;
	text-align: center;
}
</style>
		<script type="text/javascript">
			function handleLoginRequest(xhr, status, args) {
				if (args.validationFailed || !args.loggedIn) {
				} else {
					PF('eventDialog').hide();
					$('#loginLink').fadeOut();
				}
			}
		</script>
	</ui:define>

	<ui:define name="content">
		<h:form id="formAgendamento">
			<p:tabView id="tabView">
				<p:ajax event="tabChange" listener="#{scheduleBean.buscaPreco}"
					update="@form" />
				<p:tab id="tabAgenda" title="Agendamento">
					<div align="center">
						<div align="center" style="width: 1200px">
							<p:panel header="Agendamento de Consultas"
								rendered="#{contextoBean.possuiAcesso('ATE', 'ADMIN')}">
								<p:schedule value="#{scheduleBean.model}" showWeekends="false"
									initialDate="#{scheduleBean.dataAtualSchedule}"
									widgetVar="scheduleAgendamento" id="scheduleAgendamento"
									allDaySlot="false" centerHeaderTemplate="true" timeZone="GMT-3"
									locale="pt_BR" scrollTime="18:00" tooltip="true"
									timeFormat="HH:mm" axisFormat="HH:mm" view="agendaWeek"
									minTime="8:00" maxTime="20:00" aspectRatio="2.0">

									<!-- DATA SELECIONADA -->
									<p:ajax event="dateSelect"
										listener="#{scheduleBean.onDateSelect}"
										update="#{p:component('formScheduleDialog')}"
										oncomplete="PF('eventDialog').show();" />

									<!-- EVENTO SELECIONADO DO AGENDAMENTO -->
									<p:ajax event="eventSelect"
										listener="#{scheduleBean.onEventSelect}"
										update="#{p:component('formScheduleDialog')}"
										oncomplete="PF('eventDialog').show();" />
								</p:schedule>
							</p:panel>
						</div>
					</div>
				</p:tab>
				<p:tab title="Tabela de Preços">
					<div class="ui-fluid">
						<p:panel header="Tabela de Preços" style="text-align:center">
					<div class="ui-g">
						<div class="ui-g-12">
							<h:panelGroup id="botoes">
								<div class="ui-g-12 ui-lg-3">
									<p:selectOneRadio value="#{scheduleBean.campoBuscaAtivo}"
										style="padding-left: 10% !important">
										<f:selectItem itemLabel="Todos" itemValue="T" />
										<f:selectItem itemLabel="Ativo" itemValue="A" />
										<f:selectItem itemLabel="Inativo" itemValue="I" />
										<p:ajax event="change" listener="#{scheduleBean.buscaPreco}" update="carousel" />
									</p:selectOneRadio>
								</div>
							</h:panelGroup>
							<div class="ui-g-12 ui-lg-2">
								<div class="ui-inputgroup">
									<p:inputText value="#{scheduleBean.campoBuscaNome}"
									placeholder="Buscar pelo Nome" id="inputMedico"
									style="height:40px; "/>
									<p:commandButton style="height:40px;" icon="ui-icon-search"
										id="btnBuscatxt" actionListener="#{scheduleBean.buscaPreco}"
										update=" inputMedico,carousel" />
								</div>
							</div>

						</div>
					</div>
				</p:panel>
						<p:panel >
						<div class="ui-g">
							<div class="ui-g-12 ui-md-12 ui-lg-12 ui-sm-12">
								<p:carousel id="carousel" value="#{scheduleBean.lstPrecos}" var="d" footerText="Total de Médicos #{scheduleBean.lstPrecos.size()}"
								circular="true"  
									responsive="true">
									<p:outputPanel styleClass="tituloCard">
										<p:outputLabel value="#{d.pessoa.pessoaNome.toUpperCase()}"
											style="font-size: large; font-weight:bold;color :white" />
									</p:outputPanel>
									<p:outputPanel styleClass="subEspecialidade">
										<p:outputLabel value="Especialidades: " style="font-size: large; font-weight:bold"  />
										<p:outputLabel value="#{d.especialidades}"
											style="font-size: large; font-weight:bold" />
									</p:outputPanel>
									<p:outputPanel styleClass="valorConsulta">
										<p:outputLabel value="VALOR DA CONSULTA R$ #{d.precoConsulta.valor}"
											style="font-size: large; font-weight:bold;color:white  " />
									</p:outputPanel>
								</p:carousel>
							</div>
						</div>
						</p:panel>
					</div>
				</p:tab>
				<p:tab title="Lista">
					<p:panel>
			<div class="ui-fluid">
				<p:panel header="Pesquisa de Agendamentos" style="text-align:center">
					<div class="ui-g">
						<div class="ui-g-12">
							<h:panelGroup id="botao">
							
							<div class="ui-g-12 ui-lg-4">
								<p:selectOneRadio value="#{scheduleBean.campoBuscaTipoAgendamento}"
									style="padding-left: 10% !important">
									<f:selectItem itemLabel="Agendada" itemValue="CA" />
									<f:selectItem itemLabel="Confirmada" itemValue="CC" />
									<f:selectItem itemLabel="Retorno" itemValue="RE" />
									<p:ajax event="change" listener="#{scheduleBean.buscaEvento}"
										update="table" />
								</p:selectOneRadio>
							</div>
							</h:panelGroup>
							<div class="ui-g-12 ui-lg-2">
								<p:calendar id="inicio"  pattern="dd/MM/yyyy" value="#{scheduleBean.campoDataInicio}"
									placeholder="Data Inicio" />
							</div>
							
							<div class="ui-g-12 ui-lg-2">
								<p:calendar id="fim"  pattern="dd/MM/yyyy" value="#{scheduleBean.campoDataFim}"
									placeholder="Data Fim" />
							</div>		
	

							<div class="ui-g-12 ui-lg-2">
								<p:inputText value="#{scheduleBean.campoBuscaPaciente}"
									placeholder="Buscar pelo Paciente" id="inputNome"
									style="height:40px; ">

								</p:inputText>
							</div>

							<div class="ui-g-12 ui-lg-2 ">
								<div class="ui-inputgroup">
									<p:inputText value="#{scheduleBean.campoBuscaMedico}"
										placeholder="Buscar pelo Médico" id="inputCPF"
										style="height:40px; " />
									<p:commandButton style="height:40px;" icon="ui-icon-search"
										 actionListener="#{scheduleBean.buscaEvento}"
										update="table" />
								</div>
							</div>
							<div class="ui-g-12 ui-lg-1">
									<p:commandLink	rendered="#{scheduleBean.lstEvento.size() > 0}"
										actionListener="#{scheduleBean.geraRelatorio}">
										<h:graphicImage	library="img" name="pdf-icon.png" height="40" width="40" />
									</p:commandLink>
							</div>
						</div>
					</div>
				</p:panel>
				<p:panel>
					<div class="ui-g">
						<br />
						<p:dataTable value="#{scheduleBean.lstEvento}" var="d"
							emptyMessage="Não Há Registros Lançados"
							 rowKey="#{d.id}"
							selectionMode="single" id="table" rows="10" paginator="true" 
							selection="#{scheduleBean.evento}">

							<p:ajax event="rowSelect" listener="#{scheduleBean.onRowSelect}"
								update="table" />

							<p:column headerText="Paciente" priority="1"
								style="overflow: hidden;text-align: left; font-size: large">
								<p:outputLabel
									value="#{d.paciente.pessoa.pessoaNome}"/>
							</p:column>
							
							<p:column headerText="Data Inicio" priority="1"
								style="overflow: hidden;text-align: left; font-size: large">
								<p:outputLabel
									value="#{d.dataInicio}">
										<f:convertDateTime pattern="dd/MM/yyyy HH:mm" />
									</p:outputLabel>
							</p:column>

							<p:column headerText="Data Inicio" priority="1"
								style="overflow: hidden;text-align: left; font-size: large">
								<p:outputLabel value="#{d.dataFim}">
									<f:convertDateTime pattern="dd/MM/yyyy HH:mm" />
								</p:outputLabel>
							</p:column>

							<p:column headerText="Médico" priority="1"
								style="overflow: hidden;text-align: left; font-size: large">
								<p:outputLabel value="#{d.medico.pessoa.pessoaNome}" />
							</p:column>

						</p:dataTable>
					</div>
				</p:panel>
			</div>
					</p:panel>
				</p:tab>
			</p:tabView>

		</h:form>

		<p:growl id="avisosGrowl" />
		<p:dialog widgetVar="eventDialog" id="eventDialog" responsive="true"
			dynamic="true" resizable="false" closable="true" showEffect="true"
			modal="true" width="580" header="Agendamento">
			<h:form id="formScheduleDialog">
				<div class="ui-fluid">
					<p:hotkey bind="esc" handler="PF('eventDialog').hide();" />
					<div class="ui-g">
						<div class="ui-g-12">
							<p:outputLabel value="Titulo:" rendered="false" />
							<p:inputText id="titulo" value="#{scheduleBean.evento.titulo}"
								rendered="false"
								requiredMessage="Informar Titulo do Agendamento"
								placeholder="Titulo do Agendamento" size="30" />
							<p:outputLabel value="Descrição" rendered="false" />
							<p:inputTextarea id="descricao" rows="2" autoResize="true"
								rendered="false" value="#{scheduleBean.evento.descricao}"
								style="width: 242px" />

							<div class="ui-g">
								<p:outputLabel value="Paciente" />
								<div class="ui-inputgroup">
									<p:autoComplete id="paciente"
										completeMethod="#{auxController.completePaciente}"
										forceSelection="true" converter="entityConverter" var="a"
										itemLabel="#{a.pessoa.pessoaNome}" itemValue="#{a}"
										value="#{scheduleBean.evento.paciente}" minQueryLength="2"
										dropdown="true" maxResults="30" required="false" size="56"
										requiredMessage="Informe um paciente">
										<p:column id="p">
											<h:outputText value="#{a.pessoa.pessoaNome.toUpperCase()}" />
										</p:column>
										<p:ajax event="change"
											listener="#{scheduleBean.pacienteEtiqueta}" update="titulo" />
										<p:ajax event="itemSelect"
											listener="#{scheduleBean.pacienteEtiqueta}" update="titulo" />
									</p:autoComplete>
									<p:commandButton icon="ui-icon-plus" immediate="true"
										action="#{pacienteBean.redirecionarFindEntidade}">
										<p:confirm icon="ui-icon-mail-closed"
											message="Você será redirecionado para tela de cadastro de paciente, deseja continuar?" />
										<p:confirmDialog global="true" showEffect="fade"
											hideEffect="fade">
											<div align="center">
												<p:commandButton value="Sim" type="button"
													styleClass="ui-confirmdialog-yes" icon="ui-icon-check" />
												<p:commandButton value="Não" type="button"
													styleClass="ui-confirmdialog-no" icon=" ui-icon-close" />
											</div>
										</p:confirmDialog>
									</p:commandButton>
								</div>
							</div>
							<br />
							<div class="ui-g">
								<p:outputLabel value="Medico" />
								<p:autoComplete id="medico"
									completeMethod="#{auxController.completeMedico}"
									forceSelection="true" converter="entityConverter" var="a"
									itemLabel="#{a.pessoa.pessoaNome}" itemValue="#{a}"
									value="#{scheduleBean.evento.medico}" minQueryLength="1"
									dropdown="true" maxResults="30" required="true" size="60"
									requiredMessage="Informe um médico">
									<p:column>
										<h:outputText
											value="#{a.pessoa.pessoaNome.toUpperCase()} | #{a.especialidades}" />
									</p:column>
									<p:ajax event="change"
										listener="#{scheduleBean.medicoEtiqueta}" update="descricao" />

									<p:ajax event="itemSelect"
										listener="#{scheduleBean.medicoEtiqueta}" update="descricao" />
								</p:autoComplete>
							</div>
							<br />
							<div class="ui-g">
								<p:outputLabel value="Tipo de Agendamento" />
								<br /> <br />
								<p:selectOneButton value="#{scheduleBean.evento.tipoEvento}"
									styleClass="inputAgenda" required="true" style="width : 100%"
									requiredMessage="Informe um tipo de agendamento">
									<f:selectItems value="#{scheduleBean.tiposEventos}"
										var="tipoEvento" itemLabel="#{tipoEvento.descricao}" />
								</p:selectOneButton>
							</div>

							<div class="ui-g">

								<div class="ui-g-12 ui-lg-6">
									<p:outputLabel value="Inicio" />
									<p:calendar id="dti" pattern="dd/MM/yyyy HH:mm"
										popupIconOnly="true" alt="Agendamento Inicio"
										mindate="#{scheduleBean.dataAtual}" locale="pt_BR"
										required="true" disabledWeekends="true"
										requiredMessage="Informe uma data Inicio para o Agendamento"
										autocomplete="true" showButtonPanel="true" maxHour="17"
										timeZone="GMT-3" minHour="8" showTodayButton="false"
										value="#{scheduleBean.evento.dataInicio}">
										<p:ajax event="blur"
											listener="#{scheduleBean.atualizaValorDataFim}" update="dtf" />
										<p:ajax event="change"
											listener="#{scheduleBean.atualizaValorDataFim}" update="dtf" />
									</p:calendar>
								</div>
								<div class="ui-g-12 ui-lg-6">
									<p:outputLabel value="Fim" />
									<p:calendar id="dtf" value="#{scheduleBean.evento.dataFim}"
										locale="pt_BR" autocomplete="true" popupIconOnly="true"
										required="true" disabledWeekends="true"
										requiredMessage="Informe uma data Fim para o Agendamento"
										showButtonPanel="true" showTodayButton="false" maxHour="17"
										timeZone="GMT-3" minHour="8" pattern="dd/MM/yyyy HH:mm">
									</p:calendar>
								</div>
							</div>
							<div class="ui-g">
								<p:commandButton value="Salvar"
									style="height:40px;  margin: 0 auto; 
									width:130px; 
									background-color: green; 
									background: green; 
									color:white !important;
									font-size:large;"
									update="avisosGrowl,:formAgendamento:tabView:scheduleAgendamento,paciente, medico,dti, dtf"
									oncomplete="if (!args.validationFailed) PF('eventDialog').hide()"
									actionListener="#{scheduleBean.salvar()}">
								</p:commandButton>

								<p:commandButton value="Fechar"
									style="height:40px;  margin: 0 auto; 
									width:130px; 
									background-color: gray; 
									background: gray; 
									color:white !important;
									font-size:large;"
									onclick="PF('eventDialog').hide(); return false;" />

								<p:commandButton value="Remover"
									action="#{scheduleBean.remover}"
									rendered="#{scheduleBean.evento.id != null}"
									style="height:40px;  margin: 0 auto; 
									width:130px; 
									background-color: red; 
									background: red; 
									color:white !important;
									font-size:large;"
									update="avisosGrowl,@form,:formAgendamento:tabView:scheduleAgendamento">
									<p:confirm
										message="Confirmar Remoção do Agendamento Selecionado?"
										icon="ui-icon-mail-closed" />
								</p:commandButton>

								<p:confirmDialog global="true" showEffect="fade"
									hideEffect="fade">
									<div align="center">
										<p:commandButton value="Sim" type="button"
											styleClass="ui-confirmdialog-yes" icon="ui-icon-check" />

										<p:commandButton value="Não" type="button"
											styleClass="ui-confirmdialog-no" icon=" ui-icon-close" />
									</div>
								</p:confirmDialog>

							</div>
						</div>
					</div>
				</div>
			</h:form>
		</p:dialog>
	</ui:define>

</ui:composition>
<ui:composition xmlns="http://www.w3.org/1999/xhtml"
	xmlns:h="http://java.sun.com/jsf/html"
	xmlns:f="http://java.sun.com/jsf/core"
	xmlns:util="http://java.sun.com/jsf/composite/componentes"
	xmlns:ui="http://java.sun.com/jsf/facelets"
	xmlns:p="http://primefaces.org/ui" template="/WEB-INF/template.xhtml">

	<ui:define name="title">Pagina Inicial</ui:define>

	<ui:define name="head">

		<style type="text/css">
.ui-panel .ui-panel-title {
	margin: 0.1em 16px 0.2em 0;
	font-size: large;
}

.ui-state-active, .ui-widget-content .ui-state-active, .ui-widget-header .ui-state-active {
    border: 1px solid #79b7e7;
    background: lightsteelblue;
    font-weight: bold;
    color: #2e6e9e !important;
}


.ui-state-active a, .ui-state-active a:link, .ui-state-active a:visited {
 color: #2e6e9e !important;
    text-decoration: none;
}
.dashboard .overview-box .overview-box-title {
	font-size: large;
	width: 100%;
	text-align: center;
	background: lightblue;
	padding: 10px;
	color: black !important;
	font-weight: bold;
}

.dashboard .overview-box .overview-box-details {
	width: 100%;
	padding: 8px 0;
	padding-left: 15px;
}

.card {
	-moz-border-radius: 2px;
	-webkit-border-radius: 2px;
	border-radius: 2px;
	background: #ffffff;
	padding: 16px;
	padding-left: 0;
	padding-right: 0;
	padding-top: 0;
	box-sizing: border-box;
	margin-bottom: 16px;
}

.ui-g label {
	font-size: medium;
	color: black;
	font-weight: bold
}

.ui-selectoneradio label {
	cursor: pointer;
	display: inline-block;
	margin: 0 16px 0 8px;
	vertical-align: middle;
	/*color: #2e6e9e !important;*/
	font-size: medium;
}

.ui-state-default, .ui-widget-content .ui-state-default,
	.ui-widget-header .ui-state-default {
	border: 1px solid #c5dbec;
	font-weight: bold;
	color: black;
}

.ui-fluid .ui-inputmask {
	font-size: 20px;
	width: 100%;
	text-align: center;
	height: 35px;
	color: black;
}

.ui-fluid .ui-inputtext {
	width: 100%;
	height: 35px;
	font-size: large;
	text-align: center;
	color: black;
}

.ui-fluid .ui-inputtextarea {
	width: 100%;
	height: 35px !important;
	color: black;
}

.ui-fluid .ui-calendar, .ui-fluid .ui-calendar input {
	width: 100%;
	height: 40px;
	/* font-size: 20px !important; */
	font-size: large;
	text-align: center;
	color: black;
}

.ui-selectonemenu label.ui-selectonemenu-label {
	cursor: pointer;
	height: 33px;
	font-size: 20px;
	text-align: center;
}

.ui-selectoneradio label {
	cursor: pointer;
	display: inline-block;
	margin: 0 16px 0 8px;
	vertical-align: middle;
	/*color: #2e6e9e !important;*/
	font-size: medium;
}

.ui-autocomplete-input.ui-autocomplete-dd-input {
	padding-right: 2.4em;
	height: 35px;
	text-align: center;
}

.consulta {
	background-color: red !important;
}

.retorno {
	background-color: green !important;
}

.confirmaConsulta {
	background-color: blue !important;
}

.value {
	font-weight: bold;
}

.ui-carousel {
	margin-bottom: 20px;
}

.tituloCard {
	background: none;
	padding: 0.5em 1em;
	background-color: #5c9ccc;
	color: white;
	text-align: center;
}

.subEspecialidade {
	background: none;
	padding: 0.5em 1em;
	color: white;
	text-align: left;
}

.valorConsulta {
	background: none;
	padding: 0.5em 1em;
	background-color: #5c9ccc;
	color: white;
	text-align: center;
}
</style>
		<script type="text/javascript">
			function handleLoginRequest(xhr, status, args) {
				if (args.validationFailed || !args.loggedIn) {
				} else {
					PF('eventDialog').hide();
					$('#loginLink').fadeOut();
				}
			}
		</script>
	</ui:define>

	<ui:define name="content">
		<h:form id="formAgendamento">
			<p:tabView id="tabView"
				rendered="#{contextoBean.possuiAcesso('ADMIN') or (contextoBean.possuiAcesso('ATE'))}">
				<!-- <p:ajax event="tabChange" listener="#{scheduleBean.buscaPreco}" update="@form" /> -->
				<p:tab id="tabAgenda" title="Dashboard Agendamento">
					<div class="ui-g dashboard">
						<div class="ui-g-12 ui-lg-9 ui-sm-12 ui-md-12">
							<div class="ui-g dashboard">
								<p:panel id="dash" header="Agendamento de Consultas"
									rendered="#{contextoBean.possuiAcesso('ATE', 'ADMIN')}">
									<p:schedule value="#{scheduleBean.model}" showWeekends="false"
										initialDate="#{scheduleBean.dataAtualSchedule}"
										widgetVar="scheduleAgendamento" id="scheduleAgendamento"
										allDaySlot="false" centerHeaderTemplate="true"
										timeZone="GMT-3" locale="pt_BR" scrollTime="18:00"
										tooltip="true" timeFormat="HH:mm" axisFormat="HH:mm"
										view="agendaWeek" minTime="8:00" maxTime="20:00"
										aspectRatio="2.0">

										<!-- DATA SELECIONADA -->
										<p:ajax event="dateSelect"
											listener="#{scheduleBean.onDateSelect}"
											update="#{p:component('formScheduleDialog')}"
											oncomplete="PF('eventDialog').show();" />

										<!-- EVENTO SELECIONADO DO AGENDAMENTO -->
										<p:ajax event="eventSelect"
											listener="#{scheduleBean.onEventSelect}"
											update="#{p:component('formScheduleDialog')}"
											oncomplete="PF('eventDialog').show();" />
									</p:schedule>
								</p:panel>
							</div>
						</div>
						<div class="ui-g-12 ui-lg-3 ui-sm-12 ui-md-12">
							<div class="ui-g dashboard">
								<div class="ui-g-12 ui-md-6 ui-lg-4">
									<div class="ui-g card overview-box overview-box-2 no-gutter">
										<div class="overview-box-title">Consultas</div>
										<div class="overview-box-details">
											<i class="fa fa-id-card  overview-box-details-icon" /> <span
												class="overview-box-details-count">#{scheduleBean.resConsulta}</span>
										</div>
									</div>
								</div>

								<div class="ui-g-12 ui-md-6 ui-lg-4">
									<div class="ui-g card overview-box overview-box-2 no-gutter">
										<div class="overview-box-title">Retorno</div>
										<div class="overview-box-details">
											<i class="fa fa-undo overview-box-details-icon" /> <span
												class="overview-box-details-count">#{scheduleBean.resRetorno}</span>
										</div>
									</div>
								</div>

								<div class="ui-g-12 ui-md-6 ui-lg-4">
									<div class="ui-g card overview-box overview-box-2 no-gutter">
										<div class="overview-box-title">Confirmadas</div>
										<div class="overview-box-details">
											<i class="fa fa-check overview-box-details-icon" /> <span
												class="overview-box-details-count">#{scheduleBean.resConfirmacao}</span>
										</div>
									</div>
								</div>




								<div class="ui-g-12 ui-md-6 ui-lg-4">
									<p:button value="Consulta" disabled="true"
										style="color: white; background: red; font-weight: bold; width : 100% !important; text-align:center;    opacity: 100" />
								</div>
								<div class="ui-g-12 ui-md-6 ui-lg-4">
									<p:button value="Retorno" disabled="true"
										style="color: white; background: green; font-weight: bold; width : 100% !important; text-align:center; opacity: 100" />
								</div>
								<div class="ui-g-12 ui-md-6 ui-lg-4">
									<p:button value="Confirmação" disabled="true"
										style="color: white; background: blue; font-weight: bold; width : 100% !important; text-align:center; opacity: 100" />
								</div>
							</div>
						</div>
					</div>
				</p:tab>
				<p:tab title="Lista de Agendamentos">
					<div class="ui-fluid">
						<p:panel id="panel" header="Pesquisa de Agendamentos"
							style="text-align:center">
							<div class="ui-g">
								<div class="ui-g-12">
									<h:panelGroup id="botao">
										<div class="ui-g-12 ui-lg-4">
											<p:selectOneRadio
												value="#{scheduleBean.campoBuscaTipoAgendamento}"
												style="padding-left: 10% !important">
												<f:selectItem itemLabel="Agendada" itemValue="CA" />
												<f:selectItem itemLabel="Confirmada" itemValue="CC" />
												<f:selectItem itemLabel="Retorno" itemValue="RE" />
												<p:ajax event="change"
													listener="#{scheduleBean.buscaEvento}" update="table panel" />
											</p:selectOneRadio>
										</div>
									</h:panelGroup>

									<div class="ui-g-12 ui-lg-1">
										<p:calendar id="inicio" pattern="dd/MM/yyyy"
											value="#{scheduleBean.campoDataInicio}" navigator="true"
											placeholder="Data Inicio" />
									</div>

									<div class="ui-g-12 ui-lg-1">
										<p:calendar id="fim" pattern="dd/MM/yyyy" navigator="true"
											value="#{scheduleBean.campoDataFim}" placeholder="Data Fim" />
									</div>

									<div class="ui-g-12 ui-lg-2">
										<p:inputText value="#{scheduleBean.campoBuscaPaciente}"
											placeholder="Buscar pelo Paciente" id="inputNome"
											style="height:40px; ">

										</p:inputText>
									</div>

									<div class="ui-g-12 ui-lg-2 ">
										<div class="ui-inputgroup">
											<p:inputText value="#{scheduleBean.campoBuscaMedico}"
												placeholder="Buscar pelo Médico" id="inputCPF"
												style="height:40px; " />
											<p:commandButton style="height:40px;" icon="ui-icon-search"
												actionListener="#{scheduleBean.buscaEvento}" update="table panel" />
										</div>
									</div>

									<div class="ui-g-12 ui-lg-1">
										<p:commandLink rendered="#{scheduleBean.lstEvento.size() > 0}"
											actionListener="#{scheduleBean.geraRelatorio}">
											<h:graphicImage library="img" name="pdf-icon.png" height="40"
												width="40" />
										</p:commandLink>
									</div>

								</div>
							</div>
						</p:panel>

						<p:panel>
							<div class="ui-g">
								<p:dataTable value="#{scheduleBean.lstEvento}" var="d"
									emptyMessage="Não Há Registros Lançados" rowKey="#{d.id}"
									selectionMode="single" id="table" rows="10" paginator="true"
									selection="#{scheduleBean.evento}">

									<p:ajax event="rowSelect"
										listener="#{scheduleBean.onRowSelect}" update="table" />

									<p:column headerText="Paciente" priority="1"
										style="overflow: hidden;text-align: left; font-size: large">
										<p:outputLabel value="#{d.paciente.pessoa.pessoaNome}" />
									</p:column>

									<p:column headerText="Data Inicio" priority="1"
										style="overflow: hidden;text-align: left; font-size: large">
										<p:outputLabel value="#{d.dataInicio}">
											<f:convertDateTime pattern="dd/MM/yyyy HH:mm" />
										</p:outputLabel>
									</p:column>

									<p:column headerText="Data Inicio" priority="1"
										style="overflow: hidden;text-align: left; font-size: large">
										<p:outputLabel value="#{d.dataFim}">
											<f:convertDateTime pattern="dd/MM/yyyy HH:mm" />
										</p:outputLabel>
									</p:column>

									<p:column headerText="Médico" priority="1"
										style="overflow: hidden;text-align: left; font-size: large">
										<p:outputLabel value="#{d.medico.pessoa.pessoaNome}" />
									</p:column>

								</p:dataTable>
							</div>
						</p:panel>

					</div>
				</p:tab>
				<p:tab title="Tabela de Preços">
					<div class="ui-fluid">
						<p:panel header="Tabela de Preços" style="text-align:center">
							<div class="ui-g">
								<div class="ui-g-12">
									<h:panelGroup id="botoes">
										<div class="ui-g-12 ui-lg-3">
											<p:selectOneRadio value="#{scheduleBean.campoBuscaAtivo}"
												style="padding-left: 10% !important">
												<f:selectItem itemLabel="Todos" itemValue="T" />
												<f:selectItem itemLabel="Ativo" itemValue="A" />
												<f:selectItem itemLabel="Inativo" itemValue="I" />
												<p:ajax event="change" listener="#{scheduleBean.buscaPreco}"
													update="panelRep" />
											</p:selectOneRadio>
										</div>
									</h:panelGroup>
									<div class="ui-g-12 ui-lg-2">
										<div class="ui-inputgroup">
											<p:inputText value="#{scheduleBean.campoBuscaNome}"
												placeholder="Buscar pelo Nome" id="inputMedico"
												style="height:40px; " />
											<p:commandButton style="height:40px;" icon="ui-icon-search"
												id="btnBuscatxt" actionListener="#{scheduleBean.buscaPreco}"
												update=" inputMedico panelRep" />
										</div>
									</div>

								</div>
							</div>
						</p:panel>
						<p:panel id="panelRep">
							<div class="ui-g">
								<div class="ui-g-12 ui-lg-12 ui-sm-12 ui-md-12">
									<div class="ui-g dashboard">
										<p:repeat id="rep" var="d" value="#{scheduleBean.lstPrecos}">
											<div class="ui-g-12 ui-md-6 ui-lg-3">
												<div class="ui-g card overview-box overview-box-3 no-gutter">
													<div class="overview-box-title">
														<p:outputLabel value="#{d.pessoa.pessoaNome}"
															style="font-size: x-large;" />
													</div>
													<div class="overview-box-details">
														<i class="fa fa-stethoscope  overview-box-details-icon" />
														<span class="overview-box-details-count">#{d.especialidades}</span><br />
														<i class="fa fa-money  overview-box-details-icon" /> <span
															class="overview-box-details-count">R$
															#{d.precoConsulta.valor}</span>
													</div>
												</div>
											</div>
										</p:repeat>
									</div>
								</div>
							</div>
						</p:panel>
					</div>
				</p:tab>
			</p:tabView>
			<p:outputPanel rendered="#{contextoBean.possuiAcesso('EST')}">
				<div class="ui-g dashboard">
					<div class="ui-g-12 ui-md-6 ui-lg-2">
						<div class="ui-g card overview-box overview-box-2 no-gutter">
							<div class="overview-box-title">Pedidos Aprovados</div>
							<div class="overview-box-details">
								<i class="fa fa-check overview-box-details-icon" /> <span
									class="overview-box-details-count">#{scheduleBean.estAprovado}</span>
							</div>
						</div>
					</div>
					<div class="ui-g-12 ui-md-6 ui-lg-2">
						<div class="ui-g card overview-box overview-box-3 no-gutter">
							<div class="overview-box-title">Pedidos Reprovados</div>
							<div class="overview-box-details">
								<i class="fa fa-folder overview-box-details-icon" /> <span
									class="overview-box-details-count">#{scheduleBean.estReprovado}</span>
							</div>
						</div>
					</div>
					<div class="ui-g-12 ui-md-6 ui-lg-2">
						<div class="ui-g card overview-box overview-box-4 no-gutter">
							<div class="overview-box-title">Pedidos Em análise</div>
							<div class="overview-box-details">
								<i class="fa fa-user overview-box-details-icon" /> <span
									class="overview-box-details-count">#{scheduleBean.estEmAnalise}</span>
							</div>
						</div>
					</div>

					<div class="ui-g-12 ui-md-6 ui-lg-2">
						<div class="ui-g card overview-box overview-box-4 no-gutter">
							<div class="overview-box-title">Alocados(Médico)</div>
							<div class="overview-box-details">
								<i class="fa fa-user-md overview-box-details-icon" /> <span
									class="overview-box-details-count">#{scheduleBean.estAlocaMedico}</span>
							</div>
						</div>
					</div>

					<div class="ui-g-12 ui-md-6 ui-lg-2">
						<div class="ui-g card overview-box overview-box-4 no-gutter">
							<div class="overview-box-title">Alocados(Estoque)</div>
							<div class="overview-box-details">
								<i class="fa fa-cubes overview-box-details-icon" /> <span
									class="overview-box-details-count">#{scheduleBean.estAlocaEstoque}</span>
							</div>
						</div>
					</div>


					<div class="ui-g-12 ui-md-6 ui-lg-2">
						<div class="ui-g card overview-box overview-box-4 no-gutter">
							<div class="overview-box-title">Alocados(Recepção)</div>
							<div class="overview-box-details">
								<i class="fa fa-user overview-box-details-icon" /> <span
									class="overview-box-details-count">#{scheduleBean.estAlocaRecepcao}</span>
							</div>
						</div>
					</div>
				</div>
			</p:outputPanel>

		</h:form>

		<p:growl id="avisosGrowl" />
		<p:dialog widgetVar="eventDialog" id="eventDialog" responsive="true"
			dynamic="true" resizable="false" closable="true" showEffect="true"
			modal="true" width="580" header="Agendamento">
			<h:form id="formScheduleDialog">
				<div class="ui-fluid">
					<p:hotkey bind="esc" handler="PF('eventDialog').hide();" />
					<div class="ui-g">
						<div class="ui-g-12">
							<p:outputLabel value="Titulo:" rendered="false" />
							<p:inputText id="titulo" value="#{scheduleBean.evento.titulo}"
								rendered="false"
								requiredMessage="Informar Titulo do Agendamento"
								placeholder="Titulo do Agendamento" size="30" />
							<p:outputLabel value="Descrição" rendered="false" />
							<p:inputTextarea id="descricao" rows="2" autoResize="true"
								rendered="false" value="#{scheduleBean.evento.descricao}"
								style="width: 242px" />

							<div class="ui-g">
								<p:outputLabel value="Paciente" />
								<div class="ui-inputgroup">
									<p:autoComplete id="paciente"
										completeMethod="#{auxController.completePaciente}"
										forceSelection="true" converter="entityConverter" var="a"
										itemLabel="#{a.pessoa.pessoaNome}" itemValue="#{a}"
										value="#{scheduleBean.evento.paciente}" minQueryLength="2"
										dropdown="true" maxResults="30" required="false" size="56"
										requiredMessage="Informe um paciente">
										<p:column id="p">
											<h:outputText value="#{a.pessoa.pessoaNome.toUpperCase()}" />
										</p:column>
										<p:ajax event="change"
											listener="#{scheduleBean.pacienteEtiqueta}" update="titulo" />
										<p:ajax event="itemSelect"
											listener="#{scheduleBean.pacienteEtiqueta}" update="titulo" />
									</p:autoComplete>
									<p:commandButton icon="ui-icon-plus" immediate="true"
										action="#{pacienteBean.redirecionarFindEntidade}">
										<p:confirm icon="ui-icon-mail-closed"
											message="Você será redirecionado para tela de cadastro de paciente, deseja continuar?" />
										<p:confirmDialog global="true" showEffect="fade"
											hideEffect="fade">
											<div align="center">
												<p:commandButton value="Sim" type="button"
													styleClass="ui-confirmdialog-yes" icon="ui-icon-check" />
												<p:commandButton value="Não" type="button"
													styleClass="ui-confirmdialog-no" icon=" ui-icon-close" />
											</div>
										</p:confirmDialog>
									</p:commandButton>
								</div>
							</div>
							<br />
							<div class="ui-g">
								<p:outputLabel value="Medico" />
								<p:autoComplete id="medico"
									completeMethod="#{auxController.completeMedico}"
									forceSelection="true" converter="entityConverter" var="a"
									itemLabel="#{a.pessoa.pessoaNome}" itemValue="#{a}"
									value="#{scheduleBean.evento.medico}" minQueryLength="1"
									dropdown="true" maxResults="30" required="true" size="60"
									requiredMessage="Informe um médico">
									<p:column>
										<h:outputText
											value="#{a.pessoa.pessoaNome.toUpperCase()} | #{a.especialidades}" />
									</p:column>
									<p:ajax event="change"
										listener="#{scheduleBean.medicoEtiqueta}" update="descricao" />

									<p:ajax event="itemSelect"
										listener="#{scheduleBean.medicoEtiqueta}" update="descricao" />
								</p:autoComplete>
							</div>
							<br />
							<div class="ui-g">
								<p:outputLabel value="Tipo de Agendamento" />
								<br /> <br />
								<p:selectOneButton value="#{scheduleBean.evento.tipoEvento}"
									styleClass="inputAgenda" required="true" style="width : 100%"
									requiredMessage="Informe um tipo de agendamento">
									<f:selectItems value="#{scheduleBean.tiposEventos}"
										var="tipoEvento" itemLabel="#{tipoEvento.descricao}" />
								</p:selectOneButton>
							</div>

							<div class="ui-g">

								<div class="ui-g-12 ui-lg-6">
									<p:outputLabel value="Inicio" />
									<p:calendar id="dti" pattern="dd/MM/yyyy HH:mm"
										popupIconOnly="true" alt="Agendamento Inicio"
										mindate="#{scheduleBean.dataAtual}" locale="pt_BR"
										required="true" disabledWeekends="true"
										requiredMessage="Informe uma data Inicio para o Agendamento"
										autocomplete="true" showButtonPanel="true" maxHour="17"
										timeZone="GMT-3" minHour="8" showTodayButton="false"
										value="#{scheduleBean.evento.dataInicio}">
										<p:ajax event="blur"
											listener="#{scheduleBean.atualizaValorDataFim}" update="dtf" />
										<p:ajax event="change"
											listener="#{scheduleBean.atualizaValorDataFim}" update="dtf" />
									</p:calendar>
								</div>
								<div class="ui-g-12 ui-lg-6">
									<p:outputLabel value="Fim" />
									<p:calendar id="dtf" value="#{scheduleBean.evento.dataFim}"
										locale="pt_BR" autocomplete="true" popupIconOnly="true"
										required="true" disabledWeekends="true"
										requiredMessage="Informe uma data Fim para o Agendamento"
										showButtonPanel="true" showTodayButton="false" maxHour="17"
										timeZone="GMT-3" minHour="8" pattern="dd/MM/yyyy HH:mm">
									</p:calendar>
								</div>
							</div>
							<div class="ui-g">

								<p:commandButton value="Fechar"
									style="height:40px;  margin: 0 auto; 
									width:130px; 
									background-color: gray; 
									background: gray; 
									color:white !important;
									font-size:large;"
									onclick="PF('eventDialog').hide(); return false;" />


								<p:commandButton value="Remover"
									action="#{scheduleBean.remover}"
									rendered="#{scheduleBean.evento.id != null and (scheduleBean.evento.tipoEvento.descricao ne 'Confirmar' )}"
									style="height:40px;  margin: 0 auto; 
									width:130px; 
									background-color: red; 
									background: red; 
									color:white !important;
									font-size:large;"
									update="avisosGrowl,@form,:formAgendamento:tabView:scheduleAgendamento">
									<p:confirm
										message="Confirmar Remoção do Agendamento Selecionado?"
										icon="ui-icon-mail-closed" />
								</p:commandButton>

								<p:commandButton value="Salvar"
									style="height:40px;  margin: 0 auto; 
									width:130px; 
									background-color: green; 
									background: green; 
									color:white !important;
									font-size:large;"
									rendered="#{scheduleBean.evento.tipoEvento.descricao ne 'Confirmar'}"
									update="avisosGrowl,:formAgendamento:tabView:scheduleAgendamento,paciente, medico,dti, dtf :formAgendamento:tabView"
									oncomplete="if (!args.validationFailed) PF('eventDialog').hide()"
									actionListener="#{scheduleBean.salvar()}">
								</p:commandButton>

								<p:confirmDialog global="true" showEffect="fade"
									hideEffect="fade">
									<div align="center">
										<p:commandButton value="Sim" type="button"
											styleClass="ui-confirmdialog-yes" icon="ui-icon-check" />

										<p:commandButton value="Não" type="button"
											styleClass="ui-confirmdialog-no" icon=" ui-icon-close" />
									</div>
								</p:confirmDialog>

							</div>
						</div>
					</div>
				</div>
			</h:form>
		</p:dialog>
	</ui:define>

</ui:composition>